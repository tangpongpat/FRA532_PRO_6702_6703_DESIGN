#ifndef ENCODER_H
#define ENCODER_H

#include <Arduino.h>

class Encoder {
public:
    Encoder(uint8_t pinA, uint8_t pinB);
    void begin();
    long getPosition();
    void reset();

private:
    uint8_t _pinA, _pinB;
    volatile long _position;

    static Encoder* instances[3];
    uint8_t instanceIndex;

    void IRAM_ATTR handleInterrupt();

    static void IRAM_ATTR isrA_wrapper0();
    static void IRAM_ATTR isrA_wrapper1();
    static void IRAM_ATTR isrA_wrapper2();
};

#endif